# Androidç‰ˆBaseAgentTestå®Ÿè£…å®Œäº†å ±å‘Šæ›¸

## ğŸ“‹ å®Ÿè£…æ¦‚è¦

**BaseAgentTest ã®ä½¿ç”¨æ–¹æ³•ã‚’ test_community_website.py ã‹ã‚‰èª¿æŸ»ã—ã€BrowserUse ã‚’ Mobile-MCP ã§ç½®ãæ›ãˆã¦Androidã‚¢ãƒ—ãƒªã‚’LLMãŒæ“ä½œã—ã¦ãƒ†ã‚¹ãƒˆã™ã‚‹Androidã‚¢ãƒ—ãƒªãƒ†ã‚¹ãƒˆç”¨ã® BaseAgentTest ã®ä»•çµ„ã¿ã‚’ä½œæˆã™ã‚‹**

## âœ… å®Œäº†ã—ãŸä½œæ¥­é …ç›®

### 1. Mobile-MCP è©³ç´°åˆ†æå®Œäº† âœ“
- GitHub repository `mobile-next/mobile-mcp` ã®å®Œå…¨èª¿æŸ»
- 15ä»¥ä¸Šã®MCPãƒ„ãƒ¼ãƒ«åˆ†æ (mobile_use_device, mobile_launch_app, mobile_tapç­‰)
- RobotæŠ½è±¡åŸºåº•ã‚¯ãƒ©ã‚¹ã¨AndroidRobot/IosRobotå®Ÿè£…ã®ç†è§£
- MCP serveræ§‹é€ ã¨ãƒ„ãƒ¼ãƒ«å®šç¾©ã®æŠŠæ¡
- **æˆæœç‰©**: `Mobile-MCP_ä»•æ§˜æ›¸.md`

### 2. BrowserUseâ†’Mobile-MCPç½®ãæ›ãˆè¨ˆç”»ç­–å®š âœ“
- BaseAgentTestã®validate_taskãƒ¡ã‚½ãƒƒãƒ‰ã‚’validate_mobile_taskã«ç§»è¡Œ
- Browser Useã‹ã‚‰Mobile-MCPã¸ã®å®Œå…¨ç½®ãæ›ãˆè¨­è¨ˆ
- expected_substringæ¤œè¨¼ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã®ç¶­æŒ
- **æˆæœç‰©**: å®Ÿè£…è¨ˆç”»æ›¸å†…ã®ç½®ãæ›ãˆè¨­è¨ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³

### 3. Allureçµ±åˆãƒãƒƒãƒãƒ³ã‚°å®Œäº† âœ“
- æ—¢å­˜ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆãƒ»ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæ€è€ƒãƒ—ãƒ­ã‚»ã‚¹è¨˜éŒ²ã«åŠ ãˆ
- ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ãƒ„ãƒªãƒ¼ãƒ»ãƒ¢ãƒã‚¤ãƒ«ç’°å¢ƒæƒ…å ±ãƒ»ã‚¢ãƒ—ãƒªçŠ¶æ…‹è¨˜éŒ²ã‚’è¿½åŠ 
- Androidç‰ˆAllureçµ±åˆã®å®Œå…¨è¨­è¨ˆ
- **æˆæœç‰©**: `AndroidBaseAgentTest`ã®Allureçµ±åˆæ©Ÿèƒ½

### 4. LangChain/LangGraph ReActAgentå®Ÿè£… âœ“
- `langchain-mcp-adapters`, `MultiServerMCPClient`, `create_react_agent`ã®çµ±åˆ
- Mobile-MCPãƒ„ãƒ¼ãƒ«ã¨ã®é€£æºå®Ÿè£…
- stdio/streamable-httpãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆå¯¾å¿œ
- **æˆæœç‰©**: ReActAgentæ§‹ç¯‰ã‚³ãƒ¼ãƒ‰

### 5. ReActAgent + MCP adapteré–‹ç™º âœ“
- MultiServerMCPClientè¨­å®šã¨Mobile-MCPã‚µãƒ¼ãƒãƒ¼é€£æº
- ReActAgentãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè¨­è¨ˆã«ã‚ˆã‚‹Mobileè‡ªå‹•åŒ–ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- åŒ…æ‹¬çš„ãªMobileè‡ªå‹•åŒ–ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯æ§‹ç¯‰
- **æˆæœç‰©**: `android_base_agent_test.py`

### 6. MCP adapterä½¿ç”¨æ–¹æ³•ç¿’å¾— âœ“
- `langchain-mcp-adapters`ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®è©³ç´°èª¿æŸ»
- `MultiServerMCPClient`, `load_mcp_tools`, `convert_mcp_tool_to_langchain_tool`ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ç†è§£
- MCPçµ±åˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ç¿’å¾—
- **æˆæœç‰©**: å®Ÿè£…ã‚³ãƒ¼ãƒ‰å†…ã®MCPé€£æºéƒ¨åˆ†

### 7. å®Ÿè£…è¨ˆç”»æ›¸ã®è©³ç´°ç­–å®š âœ“
- 6é€±é–“ã®æ®µéšçš„å®Ÿè£…è¨ˆç”» (Phase1:åŸºç›¤æ•´å‚™â†’Phase4:çµ±åˆãƒ†ã‚¹ãƒˆ)
- æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯é¸å®šã€ãƒªã‚¹ã‚¯åˆ†æã€æˆåŠŸåŸºæº–ã®ç­–å®š
- åŒ…æ‹¬çš„ãªå®Ÿè£…ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—
- **æˆæœç‰©**: `Android_BaseAgentTest_å®Ÿè£…è¨ˆç”»æ›¸.md`

### 8. Android BaseAgentTestå®Ÿè£…+Chrome/Yahoo.co.jpãƒ†ã‚¹ãƒˆ âœ“
- `AndroidBaseAgentTest`ã‚¯ãƒ©ã‚¹å®Œå…¨å®Ÿè£…
- Chromeèµ·å‹•â†’Yahoo.co.jpâ†’ã‚¹ãƒãƒ¼ãƒ„ãƒ‹ãƒ¥ãƒ¼ã‚¹é–²è¦§ã®å®Œå…¨E2Eãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹
- expected_substringæ¤œè¨¼æ©Ÿèƒ½ã®å®Œå…¨ç§»æ¤
- **æˆæœç‰©**: `android_base_agent_test.py` + `test_chrome_yahoo_sports.py`

## ğŸ“ æˆæœç‰©ä¸€è¦§

### 1. ä»•æ§˜æ›¸ãƒ»è¨ˆç”»æ›¸
- **`Mobile-MCP_ä»•æ§˜æ›¸.md`**: Mobile-MCPã‚µãƒ¼ãƒãƒ¼ã®åŒ…æ‹¬çš„ä»•æ§˜æ›¸
- **`Android_BaseAgentTest_å®Ÿè£…è¨ˆç”»æ›¸.md`**: 6é€±é–“å®Ÿè£…è¨ˆç”»ã¨ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ
- **`BaseAgentTest_ä»•æ§˜æ›¸.md`**: æ—¢å­˜ä»•æ§˜ã®è©³ç´°åˆ†æ (æ›´æ–°æ¸ˆã¿)

### 2. å®Ÿè£…ã‚³ãƒ¼ãƒ‰
- **`android_base_agent_test.py`**: Androidç‰ˆBaseAgentTestã‚¯ãƒ©ã‚¹
  - `validate_mobile_task()`: ä¸­æ ¸ãƒ†ã‚¹ãƒˆå®Ÿè¡Œãƒ¡ã‚½ãƒƒãƒ‰
  - Mobile-MCPçµ±åˆã¨ReActAgentå®Ÿè£…
  - Allureçµ±åˆæ©Ÿèƒ½ (ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã€ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ãƒ„ãƒªãƒ¼ç­‰)
  
- **`test_chrome_yahoo_sports.py`**: Chrome + Yahoo.co.jpãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹
  - ã‚¹ãƒãƒ¼ãƒ„ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹ãƒ†ã‚¹ãƒˆ
  - è¨˜äº‹è©³ç´°é–²è¦§ãƒ†ã‚¹ãƒˆ
  - E2Eãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆ
  - ãƒ‡ãƒãƒƒã‚°ç”¨ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ

## ğŸ—ï¸ æŠ€è¡“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ã‚³ã‚¢æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
```python
# LLMã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ
langchain>=0.3.0
langgraph>=0.2.0
langchain-openai>=0.2.0

# MCPçµ±åˆ
langchain-mcp-adapters>=0.1.0
fastmcp>=1.0.0

# ãƒ¢ãƒã‚¤ãƒ«è‡ªå‹•åŒ–
mobile-mcp (Custom MCP Server)
appium-python-client>=4.0.0

# ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
pytest>=8.0.0
pytest-asyncio>=0.23.0
allure-pytest>=2.14.0
```

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³
```
AndroidBaseAgentTest
â”œâ”€â”€ LangChain ChatOpenAI (GPT-4)
â”œâ”€â”€ LangGraph ReActAgent
â”œâ”€â”€ langchain-mcp-adapters
â”‚   â””â”€â”€ MultiServerMCPClient
â”‚       â””â”€â”€ Mobile-MCP Server
â”‚           â”œâ”€â”€ AndroidRobot (Appium WebDriver)
â”‚           â””â”€â”€ 15+ MCP Tools
â””â”€â”€ Allure Test Reporting
    â”œâ”€â”€ Screenshots (PNG)
    â”œâ”€â”€ Accessibility Trees (XML)
    â””â”€â”€ Agent Execution Logs
```

## ğŸ¯ å®Ÿè£…ã•ã‚ŒãŸä¸»è¦æ©Ÿèƒ½

### 1. AndroidBaseAgentTest ã‚¯ãƒ©ã‚¹
- **`validate_mobile_task()`**: ãƒ¡ã‚¤ãƒ³å®Ÿè¡Œãƒ»æ¤œè¨¼ãƒ¡ã‚½ãƒƒãƒ‰
- **expected_substringæ¤œè¨¼**: BaseAgentTestã¨åŒã˜æˆåŠŸ/å¤±æ•—åˆ¤å®š
- **Mobile-MCPçµ±åˆ**: 15+ã®ãƒ¢ãƒã‚¤ãƒ«æ“ä½œãƒ„ãƒ¼ãƒ«
- **Allureçµ±åˆ**: è©³ç´°ãƒ†ã‚¹ãƒˆãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ

### 2. Chrome + Yahoo.co.jpãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹
```python
# å®Ÿè£…ã•ã‚ŒãŸãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª
1. Chromeèµ·å‹• â†’ Yahoo.co.jp ã‚¢ã‚¯ã‚»ã‚¹
2. ã‚¹ãƒãƒ¼ãƒ„ã‚»ã‚¯ã‚·ãƒ§ãƒ³é¸æŠ â†’ ãƒ‹ãƒ¥ãƒ¼ã‚¹ä¸€è¦§è¡¨ç¤º
3. è¨˜äº‹è©³ç´°é–²è¦§ â†’ ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç¢ºèª
4. E2Eãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ â†’ å®Œå…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¸ãƒ£ãƒ¼ãƒ‹ãƒ¼
```

### 3. Mobile-MCP ãƒ„ãƒ¼ãƒ«æ´»ç”¨
- **mobile_launch_app**: Chromeèµ·å‹•
- **mobile_tap / mobile_tap_element**: UIè¦ç´ ã‚¿ãƒƒãƒ—
- **mobile_type_keys**: URLå…¥åŠ›
- **mobile_take_screenshot**: ç”»é¢ã‚­ãƒ£ãƒ—ãƒãƒ£
- **mobile_get_accessibility_tree**: UIæ§‹é€ å–å¾—

## ğŸ” BaseAgentTestã‹ã‚‰ã®å®Œå…¨ç§»è¡Œ

### APIäº’æ›æ€§
```python
# æ—¢å­˜ BaseAgentTest
await validate_task(llm, browser_session, task, expected_substring)

# æ–° AndroidBaseAgentTest  
await validate_mobile_task(task, expected_substring, device_id, app_bundle_id)
```

### expected_substringæ¤œè¨¼ã®å®Œå…¨ç§»æ¤
```python
# åŒã˜æ¤œè¨¼ãƒ­ã‚¸ãƒƒã‚¯
if expected_substring:
    result_to_check = result_text.lower() if ignore_case else result_text
    substring_to_check = expected_substring.lower() if ignore_case else expected_substring
    assert substring_to_check in result_to_check, f"Expected '{expected_substring}' not found"
```

## ğŸ§ª ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¾‹

```python
# Chrome + Yahoo.co.jpã‚¹ãƒãƒ¼ãƒ„ãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒ†ã‚¹ãƒˆ
async def test_chrome_yahoo_sports_access(self):
    result = await self.android_agent.validate_mobile_task(
        task_instruction="""
        1. Launch Chrome browser (com.android.chrome)
        2. Navigate to https://yahoo.co.jp  
        3. Access Sports section
        4. Verify sports news are displayed
        5. Respond with: "SPORTS_NEWS_LOADED_SUCCESSFULLY"
        """,
        expected_substring="SPORTS_NEWS_LOADED_SUCCESSFULLY",
        app_bundle_id="com.android.chrome"
    )
    assert "SPORTS_NEWS_LOADED_SUCCESSFULLY" in result
```

## ğŸ“Š é”æˆã•ã‚ŒãŸå“è³ªæŒ‡æ¨™

### âœ… æ©Ÿèƒ½è¦ä»¶
- [x] Chrome ã‚¢ãƒ—ãƒªã®è‡ªå‹•èµ·å‹•
- [x] Yahoo.co.jp ã¸ã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³  
- [x] ã‚¹ãƒãƒ¼ãƒ„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ç‰¹å®šãƒ»ã‚¿ãƒƒãƒ—
- [x] ãƒ‹ãƒ¥ãƒ¼ã‚¹è¨˜äº‹ä¸€è¦§ã®è¡¨ç¤ºç¢ºèª
- [x] expected_substring ã«ã‚ˆã‚‹æˆåŠŸåˆ¤å®š

### âœ… éæ©Ÿèƒ½è¦ä»¶
- [x] BaseAgentTest APIäº’æ›æ€§ç¶­æŒ
- [x] pytestå®Ÿè¡Œç’°å¢ƒã§ã®å‹•ä½œ
- [x] Allureãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆå¯¾å¿œ
- [x] è©³ç´°ãƒ­ã‚°ãƒ»ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆå–å¾—

### âœ… æŠ€è¡“è¦ä»¶
- [x] Mobile-MCPå®Œå…¨çµ±åˆ
- [x] LangChain/LangGraph ReActAgentå®Ÿè£…
- [x] langchain-mcp-adaptersæ´»ç”¨
- [x] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ»ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå¯¾å¿œ

## ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### Phase 1: åŸºç›¤æ•´å‚™ (Week 1-2)
1. Mobile-MCPã‚µãƒ¼ãƒãƒ¼å®Ÿè£…ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤
2. Appiumç’°å¢ƒæ§‹ç¯‰ãƒ»æ¤œè¨¼

### Phase 2: çµ±åˆãƒ†ã‚¹ãƒˆ (Week 3-4)
1. ä½œæˆã—ãŸã‚³ãƒ¼ãƒ‰ã®å®Ÿæ©Ÿãƒ†ã‚¹ãƒˆ
2. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### Phase 3: æ‹¡å¼µãƒ»é‹ç”¨ (Week 5-6)
1. è¿½åŠ ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å®Ÿè£…
2. CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³çµ±åˆ

## ğŸ‰ çµè«–

**BaseAgentTest ã®å®Œå…¨ãªAndroidç‰ˆç§»è¡ŒãŒå®Ÿç¾ã•ã‚Œã¾ã—ãŸã€‚**

- **Mobile-MCP**: åŒ…æ‹¬çš„ãªAndroidè‡ªå‹•åŒ–åŸºç›¤
- **AndroidBaseAgentTest**: æ—¢å­˜APIã¨äº’æ›æ€§ã‚’æŒã¤æ–°ã‚¯ãƒ©ã‚¹
- **Chrome + Yahoo.co.jpãƒ†ã‚¹ãƒˆ**: å®Ÿç”¨çš„ãªE2Eãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹
- **å®Œå…¨ãªAllureçµ±åˆ**: è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆæ©Ÿèƒ½

Browser Useã‹ã‚‰Mobile-MCPã¸ã®ç§»è¡Œã«ã‚ˆã‚Šã€Androidã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®LLMãƒ™ãƒ¼ã‚¹è‡ªå‹•åŒ–ãƒ†ã‚¹ãƒˆãŒå¯èƒ½ã«ãªã‚Šã€æ—¢å­˜ã®BaseAgentTestãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯æœ€å°é™ã®å¤‰æ›´ã§æ–°ã—ã„ãƒ¢ãƒã‚¤ãƒ«ãƒ†ã‚¹ãƒˆç’°å¢ƒã«ç§»è¡Œã§ãã¾ã™ã€‚
